<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pro Calculator</title>

<style>
:root {
  --bg: #1e1e2f;
  --card: #2d2d44;
  --text: white;
  --btn: #4e4e73;
  --operator: #ff9800;
  --equal: #4caf50;
}

.light-mode {
  --bg: #f4f4f4;
  --card: #ffffff;
  --text: #000;
  --btn: #ddd;
}

body {
  margin: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  background: var(--bg);
  font-family: Arial, sans-serif;
  transition: 0.3s;
}

.calculator {
  background: var(--card);
  padding: 20px;
  border-radius: 15px;
  width: 350px;
  color: var(--text);
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.top-bar {
  display: flex;
  justify-content: space-between;
  margin-bottom: 10px;
}

#display {
  width: 100%;
  height: 50px;
  font-size: 22px;
  margin-bottom: 15px;
  text-align: right;
  padding: 10px;
  border: none;
  border-radius: 8px;
}

.buttons {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
}

button {
  padding: 15px;
  font-size: 18px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  background: var(--btn);
  color: var(--text);
}

.operator { background: var(--operator); }
.equal { background: var(--equal); grid-column: span 2; }
.clear { background: crimson; }

.history {
  margin-top: 15px;
  max-height: 120px;
  overflow-y: auto;
  font-size: 14px;
  background: rgba(0,0,0,0.2);
  padding: 8px;
  border-radius: 8px;
}
</style>
</head>

<body>

<div class="calculator">
  <div class="top-bar">
    <strong>Pro Calculator</strong>
    <button onclick="toggleMode()">ðŸŒ™</button>
  </div>

  <input type="text" id="display" readonly>

  <div class="buttons">
    <button class="clear">C</button>
    <button onclick="clearEntry()">CE</button>
    <button class="operator">/</button>
    <button class="operator">*</button>

    <button>7</button>
    <button>8</button>
    <button>9</button>
    <button class="operator">-</button>

    <button>4</button>
    <button>5</button>
    <button>6</button>
    <button class="operator">+</button>

    <button>1</button>
    <button>2</button>
    <button>3</button>
    <button class="equal">=</button>

    <button>0</button>
    <button>.</button>
  </div>

  <div class="history" id="history"></div>
</div>

<script>
const display = document.getElementById("display");
const buttons = document.querySelectorAll(".buttons button");
const historyDiv = document.getElementById("history");

loadHistory();

buttons.forEach(btn => {
  btn.addEventListener("click", () => {
    const value = btn.textContent;

    if (value === "C") display.value = "";
    else if (value === "=") calculate();
    else if (!["CE"].includes(value)) display.value += value;
  });
});

function calculate() {
  try {
    const expression = display.value;
    const result = Function('"use strict"; return (' + expression + ')')();
    display.value = result;
    addHistory(expression + " = " + result);
  } catch {
    display.value = "Error";
  }
}

function clearEntry() {
  display.value = display.value.slice(0, -1);
}

function toggleMode() {
  document.body.classList.toggle("light-mode");
}

function addHistory(entry) {
  let history = JSON.parse(localStorage.getItem("calcHistory")) || [];
  history.push(entry);
  localStorage.setItem("calcHistory", JSON.stringify(history));
  loadHistory();
}

function loadHistory() {
  let history = JSON.parse(localStorage.getItem("calcHistory")) || [];
  historyDiv.innerHTML = history.slice(-5).reverse().join("<br>");
}

document.addEventListener("keydown", e => {
  if (!isNaN(e.key) || "+-*/.".includes(e.key))
    display.value += e.key;
  else if (e.key === "Enter") calculate();
  else if (e.key === "Backspace") clearEntry();
});
</script>

</body>
</html>